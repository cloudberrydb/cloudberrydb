--
-- Test the boundaries of some built-in datatypes
--
set datestyle to 'ISO, DMY';
set intervalstyle to 'postgres';
--
-- bit varying
--
DROP TABLE IF EXISTS dml_bitvarying;
NOTICE:  table "dml_bitvarying" does not exist, skipping
CREATE TABLE dml_bitvarying(a bit varying(2)) distributed by (a);
-- Simple DML
INSERT INTO dml_bitvarying VALUES('11');
SELECT * FROM dml_bitvarying ORDER BY 1;
 a  
----
 11
(1 row)

UPDATE dml_bitvarying SET a = '00';
SELECT * FROM dml_bitvarying ORDER BY 1;
 a  
----
 00
(1 row)

-- out of range values
INSERT INTO dml_bitvarying VALUES('111');
ERROR:  bit string too long for type bit varying(2)
SELECT * FROM dml_bitvarying ORDER BY 1;
 a  
----
 00
(1 row)

UPDATE dml_bitvarying SET a = '000';
ERROR:  bit string too long for type bit varying(2)
SELECT * FROM dml_bitvarying ORDER BY 1;
 a  
----
 00
(1 row)

--
-- Interval
--
DROP TABLE IF EXISTS dml_interval;
NOTICE:  table "dml_interval" does not exist, skipping
CREATE TABLE dml_interval(a interval) distributed by (a);
-- SIMPLE INSERTS
INSERT INTO dml_interval VALUES('178000000 years');
SELECT * FROM dml_interval ORDER BY 1;
        a        
-----------------
 178000000 years
(1 row)

INSERT INTO dml_interval VALUES('-178000000 years');
SELECT * FROM dml_interval ORDER BY 1;
        a         
------------------
 -178000000 years
 178000000 years
(2 rows)

UPDATE dml_interval SET a = '-178000000 years';
SELECT * FROM dml_interval ORDER BY 1;
        a         
------------------
 -178000000 years
 -178000000 years
(2 rows)

-- out of range values
INSERT INTO dml_interval VALUES('178000000 years 1 month');
SELECT * FROM dml_interval ORDER BY 1;
           a           
-----------------------
 -178000000 years
 -178000000 years
 178000000 years 1 mon
(3 rows)

INSERT INTO dml_interval VALUES('-178000000 years 1 month');
SELECT * FROM dml_interval ORDER BY 1;
             a             
---------------------------
 -178000000 years
 -178000000 years
 -177999999 years -11 mons
 178000000 years 1 mon
(4 rows)

UPDATE dml_interval SET a = '-178000000 years 1 month';
SELECT * FROM dml_interval ORDER BY 1;
             a             
---------------------------
 -177999999 years -11 mons
 -177999999 years -11 mons
 -177999999 years -11 mons
 -177999999 years -11 mons
(4 rows)

--
-- Numeric
--
DROP TABLE IF EXISTS dml_numeric;
NOTICE:  table "dml_numeric" does not exist, skipping
CREATE TABLE dml_numeric(a numeric) distributed by (a);
-- Simple DML
INSERT INTO dml_numeric VALUES (10e+1000);
SELECT * FROM dml_numeric ORDER BY 1;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
(1 row)

INSERT INTO dml_numeric VALUES (1e-1000);
SELECT * FROM dml_numeric ORDER BY 1;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001
 100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
(2 rows)

-- out of range values
INSERT INTO dml_numeric VALUES (1e+10000);
ERROR:  invalid input syntax for type numeric: "1e+10000"
LINE 1: INSERT INTO dml_numeric VALUES (1e+10000);
                                        ^
SELECT * FROM dml_numeric ORDER BY 1;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001
 100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
(2 rows)

UPDATE dml_numeric SET a = 1e+10000;
ERROR:  invalid input syntax for type numeric: "1e+10000"
LINE 1: UPDATE dml_numeric SET a = 1e+10000;
                                   ^
SELECT * FROM dml_numeric ORDER BY 1;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001
 100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
(2 rows)

--
-- Numeric, with a typmod
--
DROP TABLE IF EXISTS dml_numeric2;
NOTICE:  table "dml_numeric2" does not exist, skipping
CREATE TABLE dml_numeric2(a numeric(5,2)) distributed by (a);
-- Simple DML
INSERT  INTO  dml_numeric2 VALUES (1.00e+2);
SELECT * FROM dml_numeric2 ORDER BY 1;
   a    
--------
 100.00
(1 row)

UPDATE dml_numeric2 SET a = 1.00e+1;
SELECT * FROM dml_numeric2 ORDER BY 1;
   a   
-------
 10.00
(1 row)

-- out of range values
INSERT  INTO  dml_numeric2 VALUES (1.00e+3);
ERROR:  numeric field overflow
DETAIL:  A field with precision 5, scale 2 must round to an absolute value less than 10^3. Rounded overflowing value: 1000.00
SELECT * FROM dml_numeric2 ORDER BY 1;
   a   
-------
 10.00
(1 row)

UPDATE dml_numeric2 SET a = 1.00e+3;
ERROR:  numeric field overflow
DETAIL:  A field with precision 5, scale 2 must round to an absolute value less than 10^3. Rounded overflowing value: 1000.00
SELECT * FROM dml_numeric2 ORDER BY 1;
   a   
-------
 10.00
(1 row)

--
-- Timestamp without timezone
--
DROP TABLE IF EXISTS dml_timestamp;
NOTICE:  table "dml_timestamp" does not exist, skipping
CREATE TABLE dml_timestamp( a timestamp) distributed by (a);
-- Simple DML
INSERT INTO dml_timestamp VALUES (to_date('2012-02-31', 'YYYY-MM-DD BC'));
SELECT * FROM dml_timestamp ORDER BY 1;
          a          
---------------------
 2012-03-02 00:00:00
(1 row)

INSERT INTO dml_timestamp VALUES (to_date('4714-01-27 AD', 'YYYY-MM-DD BC'));
SELECT * FROM dml_timestamp ORDER BY 1;
          a          
---------------------
 2012-03-02 00:00:00
 4714-01-27 00:00:00
(2 rows)

UPDATE dml_timestamp SET a = to_date('2012-02-31', 'YYYY-MM-DD BC');
SELECT * FROM dml_timestamp ORDER BY 1;
          a          
---------------------
 2012-03-02 00:00:00
 2012-03-02 00:00:00
(2 rows)

-- out of range values
INSERT INTO dml_timestamp VALUES ('294277-01-27 AD'::timestamp);
ERROR:  timestamp out of range: "294277-01-27 AD"
LINE 1: INSERT INTO dml_timestamp VALUES ('294277-01-27 AD'::timesta...
                                          ^
SELECT * FROM dml_timestamp ORDER BY 1;
          a          
---------------------
 2012-03-02 00:00:00
 2012-03-02 00:00:00
(2 rows)

UPDATE dml_timestamp SET a = '294277-01-27 AD'::timestamp;
ERROR:  timestamp out of range: "294277-01-27 AD"
LINE 1: UPDATE dml_timestamp SET a = '294277-01-27 AD'::timestamp;
                                     ^
SELECT * FROM dml_timestamp ORDER BY 1;
          a          
---------------------
 2012-03-02 00:00:00
 2012-03-02 00:00:00
(2 rows)

--
-- Timestamp with timezone
--
DROP TABLE IF EXISTS dml_timestamptz;
NOTICE:  table "dml_timestamptz" does not exist, skipping
CREATE TABLE dml_timestamptz( a timestamptz) distributed by (a);
-- Simple DML
INSERT INTO dml_timestamptz VALUES (to_date('4714-01-27 AD', 'YYYY-MM-DD BC'));
SELECT * FROM dml_timestamptz ORDER BY 1;
           a            
------------------------
 4714-01-27 00:00:00-08
(1 row)

UPDATE dml_timestamptz SET a = to_date('4714-01-27 AD', 'YYYY-MM-DD BC');
SELECT * FROM dml_timestamptz ORDER BY 1;
           a            
------------------------
 4714-01-27 00:00:00-08
(1 row)

-- out of range values
INSERT INTO dml_timestamptz VALUES ('294277-01-27 AD'::timestamptz);
ERROR:  timestamp out of range: "294277-01-27 AD"
LINE 1: INSERT INTO dml_timestamptz VALUES ('294277-01-27 AD'::times...
                                            ^
SELECT * FROM dml_timestamptz ORDER BY 1;
           a            
------------------------
 4714-01-27 00:00:00-08
(1 row)

INSERT INTO dml_timestamptz VALUES ('4714-01-27 BC'::timestamptz);
ERROR:  timestamp out of range: "4714-01-27 BC"
LINE 1: INSERT INTO dml_timestamptz VALUES ('4714-01-27 BC'::timesta...
                                            ^
SELECT * FROM dml_timestamptz ORDER BY 1;
           a            
------------------------
 4714-01-27 00:00:00-08
(1 row)

UPDATE dml_timestamptz SET a = '4714-01-27 BC'::timestamptz;
ERROR:  timestamp out of range: "4714-01-27 BC"
LINE 1: UPDATE dml_timestamptz SET a = '4714-01-27 BC'::timestamptz;
                                       ^
SELECT * FROM dml_timestamptz ORDER BY 1;
           a            
------------------------
 4714-01-27 00:00:00-08
(1 row)

